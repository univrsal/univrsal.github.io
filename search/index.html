<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<title>start</title>
	<link rel="shortcut icon" href="../assets/img/favicon-alpha.ico" />
</head>

<body id="body">
	<style type="text/css">

		.search-box{
			-webkit-box-shadow: 0px 0px 9px 0px rgba(0,0,0,0.75);
			-moz-box-shadow: 0px 0px 9px 0px rgba(0,0,0,0.75);
			box-shadow: 0px 0px 9px 0px rgba(0,0,0,0.75);
			text-align: left;
			border: 2px solid;
			border-radius: 3px;
		}

		.search-form {
			
		}

		.search-text {
			overflow: hidden;
			border-style: none;
			font-family: monospace;
			width: 80%;
			font-size: 18px;
			margin: 8px;
		}

		body {
			background-color: #333333;
			margin: 0px;
			background-repeat: no-repeat;
			-webkit-background-size: cover;
			-moz-background-size: cover;
			-o-background-size: cover;
			background-size: cover;
		}

		.main {
			width: 100%;
			height: 100%;
			margin: 0;
			padding: 0;
		}

		.center-container {
			width: 40%;
			height: 500px;
			position:absolute;
			left:0; right:0;
			top:0; bottom:0;
			margin:auto;
			text-align: center;
		}

		.engine-list {
			list-style: none;
			float: right;
			margin: 4px;
			padding: 0;
		}

		.engine-list li {
			display: inline;
		}

		.search-engine {
			width: 30px;
			-webkit-filter: grayscale(100%);
			cursor: pointer;
			transition: 0.7s
		}

		.engine-selected {
			-webkit-filter: grayscale(0%);
			transition: 0.7s
		}

		.quick-links > ul {
			list-style: none;
			margin: 5px;
			padding: 0px;
		}

		.quick-links > ul > li {
			font-family: monospace;
			color: white;
			display: inline;
			font-size: 14px;
			margin-left: 5px;
			margin-right: 5px;
		}

		.divide {
			margin-top: 7px;
			margin-bottom: 7px;
		}

		.ql, .config-btn { 
			font-family: monospace;
			color: #9ee2ff;
			text-decoration: none;
			text-shadow: 0px 0px 7px #000000;
		}

		.center-container > img {
			-webkit-filter: drop-shadow(0 0 10px rgba(0,0,0,0.7));
			vertical-align: middle;
			z-index: -1;
			width: 50%;
		}

		.config-btn {
			cursor: pointer;
		}

		.configbar {
			bottom: 0;
			width: 0px;
			position: fixed;
			z-index: 1;
			top: 0;
			left: 0;
			overflow-x: hidden; 
			padding-top: 10px;
			transition: 0.5s; 
			-webkit-box-shadow: 0px 0px 9px 0px rgba(0,0,0,0.75);
			-moz-box-shadow: 0px 0px 9px 0px rgba(0,0,0,0.75);
			box-shadow: 0px 0px 9px 0px rgba(0,0,0,0.75);
		}

		.config-values a, h3 {
			font-family: monospace;
			margin: 4px 4px 0px 32px;
			text-decoration: none;
			font-size: 14px;
			transition: 0.3s
		}

		.config-values h3 {
			font-size: 18px;
			margin-bottom: 20px;
			font-weight: normal;
		}

		@media screen and (max-height: 450px) {
			.sidenav {padding-top: 15px;}
			.sidenav a {font-size: 18px;}
		}

		.config-text {
			border-style: solid;
			border-width: 0px 0px 1px 0px;
			font-family: monospace;
			font-size: 14px;
			width: 80%;
			margin: 0px 8px 8px 32px;
		}

		.color-input {
			margin: 8px 8px 8px 32px;
		}

		.config-color {
			padding-top: 2px;
		}

		.color-panel {
			margin-top: 2px;
			margin-right: 8px;
			min-height: 15px;
			min-width: 30px;
			width: 30px;
			border-width: 1px;
			border-style: solid;
			background-color: red;
			float: left;
			cursor: pointer;
		}

		.config-color-hex {
			font-family: monospace;
			width: 75%;
			border-style: solid;
			display: inline;
			border-width: 0px 0px 1px 0px;
		}

		.hidden {
			position: absolute;
			left: -10000px;
			top: auto;
			width: 1px;
			height: 1px;
			overflow: hidden;
		}

		.cfg-buttons {
			padding-top: 5px;
			padding-bottom: 15px;
			margin: 4px 4px 4px 32px;
		}

		.cfg-btn {
			font-family: monospace;
			font-size: 14px;
			cursor: pointer;
			padding: 3px 10px 3px 10px;
			border-width: 1px;
			border-style: solid;
			margin: 0px;
		}

		.text {
			color: white;
		}

		.text-small {
			font-size: 8px;
		}

		.text-area {
			resize: vertical;
		}

		.accent-color {
			background-color: #292929;
		}
	</style>

	<script type="text/javascript">
		var cfg_visible = false;

		function setCookie(cname, cvalue) {
			var expires = "";
			var date = new Date();
			date.setTime(date.getTime() + (900*24*60*60*1000));
			expires = "; expires=" + date.toUTCString();

			document.cookie = cname + "=" + cvalue + expires + "; path=/";
		}

		function getCookie(cname) {
			var name = cname + "=";
			var decodedCookie = decodeURIComponent(document.cookie);
			var ca = decodedCookie.split(';');
			for(var i = 0; i <ca.length; i++) {
				var c = ca[i];
				while (c.charAt(0) == ' ') {
					c = c.substring(1);
				}
				if (c.indexOf(name) == 0) {
					return c.substring(name.length, c.length);
				}
			}
			return "";
		}

		function setEngine(engineUrl, buttonId, otherButtonId) {
			setCookie("engine_url", engineUrl);
			var search_box = document.getElementById("search-formular");
			var selectedButton = document.getElementById(buttonId);
			var otherButton = document.getElementById(otherButtonId);

			search_box.setAttribute("action", "https://".concat(engineUrl));
			selectedButton.setAttribute("class", "search-engine engine-selected");
			otherButton.setAttribute("class", "search-engine");
		}

		function setLogo(path) {
			var img = document.getElementById("head-logo");
			img.src = path;
		}

		function setColorByClass(className, c) {
			var elements = document.getElementsByClassName(className);
			var i;
			for (i = 0; i < elements.length; i++) {
				elements[i].style.color = c;
			} 
		}

		function setBGColorByTag(tag, c) {
			var tags = document.getElementsByTagName(tag);
			var i;
			
			for (i = 0; i < tags.length; i++) {
				tags[i].style.backgroundColor = c;
				tags[i].style.borderColor = c;
			}
		}

		function setBGColorByClass(className, c) {
			var elements = document.getElementsByClassName(className);
			var i;

			for (i = 0; i < elements.length; i++) {
				elements[i].style.backgroundColor = c;
			} 
		}

		function setBorderColorByClass(className, c) {
			var elements = document.getElementsByClassName(className);
			var i;

			for (i = 0; i < elements.length; i++) {
				elements[i].style.borderColor = c;
			} 
		}

		function setFontByClass(className, f) {
			var elements = document.getElementsByClassName(className);
			var i;

			for (i = 0; i < elements.length; i++) {
				elements[i].style.font = f;
			}
		}

		function setFontById(id, f) {
			var element = document.getElementById(id);
			element.style.font = f;
		}

		function setBackground() {
			var bg_link = "url('".concat(bg_path).concat("') no-repeat center center fixed");
			var body = document.getElementById("body");
			body.style.background = bg_link;
		}

		function setConfig(id, val) {
			var textField = document.getElementById(id);
			if (textField !== null)
				textField.value = val;
		}

		function toggleConfig() {
			if (!cfg_visible) {
				document.getElementById("sidebar").style.width = "250px";
				cfg_visible = true;
			} else {
				document.getElementById("sidebar").style.width = "0";
				cfg_visible = false;
			}
		}

		function onPickColor(color, textBoxId, panelId) {
			var linkColorTextbox = document.getElementById(textBoxId);
			linkColorTextbox.value = color;
			document.getElementById(panelId).style.backgroundColor = color;
		}

		function selectColor(dialogId, valueId) {
			document.getElementById(dialogId).focus();
			document.getElementById(dialogId).value = document.getElementById(valueId).value;
			document.getElementById(dialogId).click();
		}

		function rebuildLinks() {
			var list = document.getElementById("ql-list");
			list.innerHTML = "";
			var li = document.createElement("li");
			var a = document.createElement("a");
			
			a.appendChild(document.createTextNode("cfg"));
			a.setAttribute("id", "config-li");
			a.setAttribute("class", "ql config-btn");
			a.setAttribute("onclick", "toggleConfig()");
			
			li.appendChild(a);
			
			var ql_split = quick_link_string.split("\n");

			var tempLi, tempA;
			for (var i = 0; i < ql_split.length; i += 2) {
				tempLi = document.createElement("li");
				tempA = document.createElement("a");

				tempA.appendChild(document.createTextNode(ql_split[i]));
				tempA.setAttribute("class", "ql");
				tempA.setAttribute("href", ql_split[i + 1]);
				tempA.setAttribute("target", "_blank");

				tempLi.appendChild(tempA);
				list.appendChild(tempLi);
			}

			list.appendChild(li);
		}

		function buildShareLink() {
			var link = "";
			link += img_path + "\\n";
			link += bg_path + "\\n";
			link += search_font + "\\n";
			link += quick_link_font + "\\n";
			link += link_color + "\\n";
			link += text_color + "\\n";
			link += bg_color + "\\n";
			link += accent_color + "\\n";
			link += getCookie("quick_links").replace(/<br>/g, "\\n")+ "\\n";
			setConfig('share-value', link);
		}

		function loadLink() {
			var link =  document.getElementById('share-value').value;
			var entries = link.split("\\n");

			img_path 		= entries[0];
			bg_path 		= entries[1];
			search_font 	= entries[2];
			quick_link_font = entries[3];
			link_color		= entries[4];
			text_color		= entries[5];
			bg_color		= entries[6];
			accent_color	= entries[7];
			
			console.log(entries);
			var text_box_text = "";

			for (var i = 8; i < entries.length; i++) {
				if (i < entries.length - 1)
					text_box_text += entries[i].concat("\n");
				else
					text_box_text += entries[i];
			}
			quick_link_string = text_box_text;
			setValues();
			applyConfig(false);
		}
	</script>
	<div class="main">
		<div class="center-container">
			
			<img class="search-img" id="head-logo" alt="Here should be a logo for your start page. Maybe you changed the path to an invalid file. Click cfg to change the path" src="../assets/img/search-logo.png">

			<div class="search-box accent-border-color">

				<form class="accent-color search-form" id="search-formular" action="https://duckduckgo.com/">
					<ul class="engine-list">
						<li><img title="Search via duckduckgo.com" id="ddg-engine" class="search-engine engine-selected" src="../assets/img/ddg.png" onclick="setEngine('duckduckgo.com', 'ddg-engine', 'google-engine')"></img></li>
						<li><img title="Search via google.com" id="google-engine" class="search-engine" src="../assets/img/google.png" onclick="setEngine('google.com/search', 'google-engine', 'ddg-engine')"></img></li>
					</ul> 
					<input class="search-text text accent-color" type="text accent-color" autofocus="autofocus" id="searchbox" name="q">
				</form> 

			</div>


			<div class="quick-links">
				<ul id="ql-list">
					<li><a class="ql" href="https://www.youtube.com/feed/subscriptions" target="_blank">yt</a></li>
					<li><a class="ql" href="https://reddit.com/" target="_blank">reddit</a></li>
					<li><a class="ql" href="https://soundcloud.com" target="_blank">sc</a></li>
					<li><a class="ql" href="https://imgur.com" target="_blank">imgur</a></li>
					<li><a id="config-li" class="ql config-btn" onclick="toggleConfig()">cfg</a></li>
				</ul>
			</div>


		</div>

		<div id="sidebar" class="configbar accent-color">
			<div class="config-values">
				<h3 class="text">Configure this screen</h3>

				<a class="text">Search logo link</a>
				<input type="text" class="config-text text accent-color" id="logo-value"/>

				<a class="text">Background link</a>
				<input type="text" class="config-text text accent-color" id="bg-value"/>

				<div class="divide accent-color"></div>

				<a class="text">Search box font</a>
				<input type="text" class="config-text text accent-color" id="sf-value"/>

				<a class="text">Quick link font</a>
				<input type="text" class="config-text text accent-color" id="qlf-value"/>

				<div class="divide accent-color"></div>

				<a class="text">Quick link color</a>
				<div class="color-input">
					<input type="color" onchange="onPickColor(this.value, 'link-color-hex', 'link-color-panel')" class="hidden" id="link-color-value"/>
					<div class="color-panel" title="Click to select color" onclick="selectColor('link-color-value', 'link-color-hex')" id="link-color-panel" ></div>
					<input type="text" onkeypress="onPickColor(this.value, 'link-color-hex', 'link-color-panel')" class="config-color-hex text accent-color" id="link-color-hex"/>
				</div>


				<a class="text">Text color</a>
				<div class="color-input">
					<input type="color" onchange="onPickColor(this.value, 'text-color-hex', 'text-color-panel')" class="hidden" id="text-color-value"/>
					<div class="color-panel" title="Click to select color" onclick="selectColor('text-color-value', 'text-color-hex')" id="text-color-panel" ></div>
					<input type="text" onkeypress="onPickColor(this.value, 'text-color-hex', 'text-color-panel')" class="config-color-hex text accent-color" id="text-color-hex"/>
				</div>

				<a class="text">Background color</a>
				<div class="color-input">
					<input type="color" onchange="onPickColor(this.value, 'bg-color-hex', 'bg-color-panel')" class="hidden" id="bg-color-value"/>
					<div class="color-panel" title="Click to select color" onclick="selectColor('bg-color-value', 'bg-color-hex')" id="bg-color-panel" ></div>
					<input type="text" onkeypress="onPickColor(this.value, 'bg-color-hex', 'bg-color-panel')" class="config-color-hex text accent-color" id="bg-color-hex"/>
				</div>

				<a class="text">Accent color</a>
				<div class="color-input">
					<input type="color" onchange="onPickColor(this.value, 'accent-color-hex', 'accent-color-panel')" class="hidden" id="accent-color-value"/>
					<div class="color-panel" title="Click to select color" onclick="selectColor('accent-color-value', 'accent-color-hex')" id="accent-color-panel" ></div>
					<input type="text" onkeypress="onPickColor(this.value, 'accent-color-hex', 'accent-color-panel')" class="config-color-hex text accent-color" id="accent-color-hex"/>
				</div>

				<div class="divide accent-color"></div>

				<a class="text">Quick links</a>
				<textarea cols="40" rows="3" class="config-text text text-area accent-color" id="ql-value"></textarea>

				<a class="text">Share link<br></a>
				<a class="text">(Enter to load)</a>
				<div class="share-area">
					<input type="text" onkeydown="if (event.keyCode == 13) loadLink()" class="config-text text accent-color share-text" id="share-value"/>
				</div>
			</div>

			<div class="cfg-buttons">
				<a class="cfg-btn text" onclick="applyConfig(false)">Save</a>
				<a class="cfg-btn text" onclick="applyConfig(true)">Reset</a>
			</div>
		</div>
	</div>

	<script type="text/javascript">
		var debug = true;

		if (debug) {
			document.getElementById("sidebar").style.width = "250px";
		}
		// initialize config of search screen

		var img_path = getCookie("image_path");
		var bg_path  = getCookie("bg_path");
		var link_color = getCookie("link_color");
		var bg_color = getCookie("bg_color");
		var accent_color = getCookie("accent_color");
		var text_color = getCookie("text_color");
		var quick_link_string = getCookie("quick_links").replace(/<br>/g, "\n");
		var engine_url = getCookie("engine_url");
		var search_font = getCookie("search_font");
		var quick_link_font = getCookie("quick_link_font");

		if (img_path === "") img_path = "../assets/img/search-logo.png";
		if (bg_path === "") bg_path = "null";
		if (link_color === "") link_color = "#9ee2ff";
		if (bg_color === "") bg_color = "#333333";
		if (accent_color === "") accent_color = "#292929";
		if (text_color === "") text_color = "#ffffff";
		if (quick_link_string === "") quick_link_string = "yt\nhttps://www.youtube.com/feed/subscriptions\nreddit\nhttps://reddit.com/\nsc\nhttps://soundcloud.com/\nimgur\nhttps://imgur.com/";

		if (engine_url === "") engine_url = "duckduckgo.com";
		if (search_font === "") search_font = "monospace";
		if (quick_link_font === "") quick_link_font = "monospace";

		function resetValues() {
			img_path = "../assets/img/search-logo.png";
			bg_path = "null";
			link_color = "#9ee2ff";
			bg_color = "#333333";
			accent_color = "#292929";
			text_color = "#ffffff";
			quick_link_string = "yt\nhttps://www.youtube.com/feed/subscriptions\nreddit\nhttps://reddit.com/\nsc\nhttps://soundcloud.com/\nimgur\nhttps://imgur.com/";
			engine_url="duckduckgo.com";
			search_font = "18px monospace";
			quick_link_font = "14px monospace";
		}

		function setValues() {
			// Apply loaded values to config screen
			setConfig('logo-value', img_path);
			setConfig('bg-value', bg_path);
			onPickColor(link_color, 'link-color-hex', 'link-color-panel')
			onPickColor(bg_color, 'bg-color-hex', 'bg-color-panel');
			onPickColor(accent_color, 'accent-color-hex', 'accent-color-panel');
			onPickColor(text_color, 'text-color-hex', 'text-color-panel');
			setConfig('ql-value', quick_link_string);
			setConfig('sf-value', search_font);
			setConfig('qlf-value', quick_link_font);

			if (engine_url === "duckduckgo.com") {
				setEngine(engine_url, 'ddg-engine', 'google-engine');
			} else {
				setEngine(engine_url, 'google-engine', 'ddg-engine');
			}
			
		}

		function applyConfig(reset) {
			if (!reset) {
				// Load values
				img_path = document.getElementById("logo-value").value;
				bg_path = document.getElementById("bg-value").value;
				link_color = document.getElementById("link-color-hex").value;
				bg_color = document.getElementById("bg-color-hex").value;
				accent_color = document.getElementById("accent-color-hex").value;
				text_color = document.getElementById("text-color-hex").value;
				search_font = document.getElementById("sf-value").value;
				quick_link_font = document.getElementById("qlf-value").value;

				quick_link_string = document.getElementById("ql-value").value;
				
			} else {
				resetValues();
			}

			// Set cookies
			setCookie("image_path", img_path);
			setCookie("bg_path", bg_path);
			setCookie("link_color", link_color);
			setCookie("bg_color", bg_color);
			setCookie("accent_color", accent_color);
			setCookie("text_color", text_color);
			setCookie("engine_url", engine_url);
			setCookie("quick_link_font", quick_link_font);
			setCookie("search_font", search_font);

			var tempCookie = quick_link_string.replace(/\n/g, "<br>");
			setCookie("quick_links", tempCookie);
			
			// Apply values
			if (img_path == "")
				img_path = "../assets/img/search-logo.png";

			rebuildLinks();

			setLogo(img_path);
			
			setBackground(bg_path);

			setColorByClass("ql", link_color);
			setColorByClass("text", text_color);
			setBGColorByClass("accent-color", accent_color);
			setBorderColorByClass("accent-border-color", accent_color);
			setColorByClass("text", text_color);
			setBGColorByTag("body", bg_color);
			setFontByClass("ql", quick_link_font);
			setFontById("searchbox", search_font);

			if (reset) setValues();
			buildShareLink();
		}

		setValues();
		applyConfig();
	</script>
</body>
</html>